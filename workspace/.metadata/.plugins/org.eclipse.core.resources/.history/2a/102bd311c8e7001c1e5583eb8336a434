package exam;

import java.sql.Connection; //연결객체
import java.sql.DriverManager;
import java.sql.ResultSet; //결과객체
import java.sql.SQLException;
import java.sql.Statement;
import java.sql.PreparedStatement;
public class DBconnection {

	public static void main(String[] args) {
	      String driver = "oracle.jdbc.driver.OracleDriver";// 이대로 써야한다.
	      String url = "jdbc:oracle:thin:@localhost:1521:xe";// 주소가 된다.
	      String user = "ddit";
	      String password = "java";

	      Connection conn = null; // 연결객체
	      ResultSet rs = null; // 결과를 보관할 객체
	      Statement stmt = null; // sql명령 객체
	      PreparedStatement pstmt = null; //

	      try {
	         Class.forName(driver);
	         conn = DriverManager.getConnection(url, user, password);

	         String sql = " select mem_id, mem_name, mem_mileage" + " from member"
	               + " where substr(mem_regno2,1,1) = '2'";
	         stmt = conn.createStatement();
	         rs = stmt.executeQuery(sql);

	         while (rs.next()) {
	            String id = rs.getString("mem_id");
	            String name = rs.getString("mem_name");
	            // column Index를 사용해도 된다. order by에 1, 2 를 쓰는 것과 같다. 그래도 해당 index(숫자)를 사용하면 뭔지
	            // 가시성이 떨어지니 습관을 드리자.
	            int mileage = rs.getInt("mem_mileage");
	            System.out.println("=====================");
	            System.out.println(id + "\t" + name + "\t" + mileage);

	         }

	      } catch (ClassNotFoundException e) {// 드라이브를 찾을때, 못찾는 경우.
	         e.printStackTrace();

	      } catch (SQLException e) {
	         e.printStackTrace();
	      } finally {
	         try {
	            if (rs != null)
	               rs.close();
	            if (stmt != null)
	               stmt.close();
	            if (conn != null)
	               conn.close();

	         } catch (Exception e) {
	            e.printStackTrace();
	         }
	      }

	   }
	}